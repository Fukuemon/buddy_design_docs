<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="814px" preserveAspectRatio="none" style="width:1608px;height:814px;" version="1.1" viewBox="0 0 1608 814" width="1608px" zoomAndPan="magnify"><defs><filter height="300%" id="f1eru6wg401cq4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="591.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="167.5" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="520.957" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="503.5" y="159.1289"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="208.4961" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="686.5" y="213.3945"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="41.6992" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="950.5" y="351.0586"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="41.6992" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1019" y="255.0938"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="199.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1091" y="451.0234"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1354" y="480.1563"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1354" y="592.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="91" x2="91" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="172" x2="172" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="508.5" x2="508.5" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="691.5" x2="691.5" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="955.5" x2="955.5" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1023.5" x2="1023.5" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1095.5" x2="1095.5" y1="86.2969" y2="727.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1358.5" x2="1358.5" y1="86.2969" y2="727.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="60" y="82.9951">ユーザー</text><ellipse cx="91" cy="13" fill="#FEFECE" filter="url(#f1eru6wg401cq4)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M91,21 L91,48 M78,29 L104,29 M91,48 L78,63 M91,48 L104,63 " fill="none" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="60" y="739.2139">ユーザー</text><ellipse cx="91" cy="752.5156" fill="#FEFECE" filter="url(#f1eru6wg401cq4)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M91,760.5156 L91,787.5156 M78,768.5156 L104,768.5156 M91,787.5156 L78,802.5156 M91,787.5156 L104,802.5156 " fill="none" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="132" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="139" y="70.9951">Frontend</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="132" y="726.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="139" y="746.2139">Frontend</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="459.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="466.5" y="70.9951">APIGateway</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="459.5" y="726.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="466.5" y="746.2139">APIGateway</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="655.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="662.5" y="70.9951">Lambda</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="655.5" y="726.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="662.5" y="746.2139">Lambda</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="919.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="926.5" y="70.9951">Cognito</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="919.5" y="726.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="926.5" y="746.2139">Cognito</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="1001.5" y="82.9951">Redis</text><path d="M1006,34 C1006,24 1024,24 1024,24 C1024,24 1042,24 1042,34 L1042,60 C1042,70 1024,70 1024,70 C1024,70 1006,70 1006,60 L1006,34 " fill="#FEFECE" filter="url(#f1eru6wg401cq4)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1006,34 C1006,44 1024,44 1024,44 C1024,44 1042,44 1042,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="1001.5" y="739.2139">Redis</text><path d="M1006,752.5156 C1006,742.5156 1024,742.5156 1024,742.5156 C1024,742.5156 1042,742.5156 1042,752.5156 L1042,778.5156 C1042,788.5156 1024,788.5156 1024,788.5156 C1024,788.5156 1006,788.5156 1006,778.5156 L1006,752.5156 " fill="#FEFECE" filter="url(#f1eru6wg401cq4)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1006,752.5156 C1006,762.5156 1024,762.5156 1024,762.5156 C1024,762.5156 1042,762.5156 1042,752.5156 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="1056.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="1063.5" y="70.9951">Backend</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="1056.5" y="726.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="1063.5" y="746.2139">Backend</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="35" x="1339.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="1346.5" y="70.9951">DB</text><rect fill="#FEFECE" filter="url(#f1eru6wg401cq4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="35" x="1339.5" y="726.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="1346.5" y="746.2139">DB</text><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="591.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="167.5" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="520.957" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="503.5" y="159.1289"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="208.4961" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="686.5" y="213.3945"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="41.6992" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="950.5" y="351.0586"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="41.6992" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1019" y="255.0938"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="199.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1091" y="451.0234"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1354" y="480.1563"/><rect fill="#FFFFFF" filter="url(#f1eru6wg401cq4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1354" y="592.6875"/><polygon fill="#A80036" points="155.5,113.4297,165.5,117.4297,155.5,121.4297,159.5,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="161.5" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="98" y="112.3638">Action</text><polygon fill="#A80036" points="491.5,155.1289,501.5,159.1289,491.5,163.1289,495.5,159.1289" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="177.5" x2="497.5" y1="159.1289" y2="159.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="307" x="184.5" y="154.063">Get: /schedules -header: {sessionId: SessionID}</text><path d="M8,130.4297 L8,170.4297 L159,170.4297 L159,140.4297 L149,130.4297 L8,130.4297 " fill="#FBFB77" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M149,130.4297 L149,140.4297 L159,140.4297 L149,130.4297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="14" y="147.4966">sessionIDを元に、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="14" y="162.6294">認証状態の確認を行う</text><polygon fill="#A80036" points="674.5,209.3945,684.5,213.3945,674.5,217.3945,678.5,213.3945" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="513.5" x2="680.5" y1="213.3945" y2="213.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="520.5" y="208.3286">Lambda Authorizer</text><path d="M701,184.6953 L701,224.6953 L878,224.6953 L878,194.6953 L868,184.6953 L701,184.6953 " fill="#FBFB77" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M868,184.6953 L868,194.6953 L878,194.6953 L868,184.6953 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="707" y="201.7622">Lambda Authorizerで、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="707" y="216.895">トークン検証の処理を呼ぶ</text><polygon fill="#A80036" points="1007,251.0938,1017,255.0938,1007,259.0938,1011,255.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="696.5" x2="1013" y1="255.0938" y2="255.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="703.5" y="250.0278">getAccessToken(sessionID: sessionID)</text><polygon fill="#A80036" points="707.5,292.793,697.5,296.793,707.5,300.793,703.5,296.793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="701.5" x2="1023" y1="296.793" y2="296.793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="713.5" y="291.7271">accessToken</text><path d="M1034,268.0938 L1034,308.0938 L1328,308.0938 L1328,278.0938 L1318,268.0938 L1034,268.0938 " fill="#FBFB77" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1318,268.0938 L1318,278.0938 L1328,278.0938 L1318,268.0938 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="1040" y="285.1606">セッションIDに紐づくアクセストークンを取得</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="1040" y="300.2935">存在しない場合は、エラーを返す</text><polygon fill="#A80036" points="938.5,347.0586,948.5,351.0586,938.5,355.0586,942.5,351.0586" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="696.5" x2="944.5" y1="351.0586" y2="351.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="703.5" y="345.9927">GetUser(accessToken: accessToken)</text><path d="M965,322.3594 L965,362.3594 L1311,362.3594 L1311,332.3594 L1301,322.3594 L965,322.3594 " fill="#FBFB77" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1301,322.3594 L1301,332.3594 L1311,332.3594 L1301,322.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="971" y="339.4263">アクセストークンを元に、職員（ユーザー）情報を取得</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="971" y="354.5591">失敗した場合、エラーを返す</text><polygon fill="#A80036" points="707.5,388.7578,697.5,392.7578,707.5,396.7578,703.5,392.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="701.5" x2="954.5" y1="392.7578" y2="392.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="713.5" y="387.6919">職員情報返却</text><polygon fill="#A80036" points="524.5,417.8906,514.5,421.8906,524.5,425.8906,520.5,421.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="518.5" x2="690.5" y1="421.8906" y2="421.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="530.5" y="416.8247">認証結果 &amp; 職員IDを返却</text><polygon fill="#A80036" points="1079,447.0234,1089,451.0234,1079,455.0234,1083,451.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="513.5" x2="1085" y1="451.0234" y2="451.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="520.5" y="445.9575">（成功時）Get: /schedules -header: {userID: userID}</text><polygon fill="#A80036" points="1342,476.1563,1352,480.1563,1342,484.1563,1346,480.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1101" x2="1348" y1="480.1563" y2="480.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1108" y="475.0903">職員情報取得</text><polygon fill="#A80036" points="1112,505.2891,1102,509.2891,1112,513.2891,1108,509.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1106" x2="1358" y1="509.2891" y2="509.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1118" y="504.2231">職員情報返却</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1101" x2="1143" y1="544.4883" y2="544.4883"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1143" x2="1143" y1="544.4883" y2="557.4883"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1102" x2="1143" y1="557.4883" y2="557.4883"/><polygon fill="#A80036" points="1112,553.4883,1102,557.4883,1112,561.4883,1108,557.4883" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="1108" y="539.4224">職員の権限情報を確認</text><path d="M1250,522.2891 L1250,562.2891 L1596,562.2891 L1596,532.2891 L1586,522.2891 L1250,522.2891 " fill="#FBFB77" filter="url(#f1eru6wg401cq4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1586,522.2891 L1586,532.2891 L1596,532.2891 L1586,522.2891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="1256" y="539.356">バックエンドでは、リクエストから権限情報を確認する</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="1256" y="554.4888">成功時、処理を実行し、レスポンスを返す</text><polygon fill="#A80036" points="1342,588.6875,1352,592.6875,1342,596.6875,1346,592.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1101" x2="1348" y1="592.6875" y2="592.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="1108" y="587.6216">権限内に存在する職員の予定情報を取得</text><polygon fill="#A80036" points="1112,617.8203,1102,621.8203,1112,625.8203,1108,621.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1106" x2="1358" y1="621.8203" y2="621.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="1118" y="616.7544">職員の予定情報を返却</text><polygon fill="#A80036" points="524.5,646.9531,514.5,650.9531,524.5,654.9531,520.5,650.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="518.5" x2="1095" y1="650.9531" y2="650.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="530.5" y="645.8872">Response"200":{schedules: schedules}</text><polygon fill="#A80036" points="188.5,676.0859,178.5,680.0859,188.5,684.0859,184.5,680.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="182.5" x2="507.5" y1="680.0859" y2="680.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="194.5" y="675.02">Response"200":{schedules: schedules}</text><polygon fill="#A80036" points="102,705.2188,92,709.2188,102,713.2188,98,709.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="96" x2="171.5" y1="709.2188" y2="709.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="108" y="704.1528">画面表示</text><!--MD5=[9015cf304f919c17470abc823da5761d]
@startuml Auth
Actor ユーザー
Participant Frontend as Front
Participant APIGateway as Gateway
Participant Lambda
Participant Cognito
Database Redis
Participant Backend as Back
Participant DB

ユーザー -> Front: Action
activate Front
Front -> Gateway: Get: /schedules -header: {sessionId: SessionID}
note left
sessionIDを元に、
認証状態の確認を行う
end note

activate Gateway
Gateway -> Lambda: Lambda Authorizer
note right
Lambda Authorizerで、
トークン検証の処理を呼ぶ
end note

activate Lambda
Lambda -> Redis: getAccessToken(sessionID: sessionID)

activate Redis
Redis - -> Lambda: accessToken
note right
セッションIDに紐づくアクセストークンを取得
存在しない場合は、エラーを返す
end note
deactivate Redis

Lambda -> Cognito: GetUser(accessToken: accessToken)
note right
アクセストークンを元に、職員（ユーザー）情報を取得
失敗した場合、エラーを返す
end note
activate Cognito
Cognito - -> Lambda: 職員情報返却
deactivate Cognito

Lambda - -> Gateway: 認証結果 & 職員IDを返却
deactivate Lambda

Gateway -> Back: （成功時）Get: /schedules -header: {userID: userID}
activate Back
Back -> DB: 職員情報取得
activate DB
DB - -> Back: 職員情報返却
deactivate DB
Back - -> Back: 職員の権限情報を確認
note right
バックエンドでは、リクエストから権限情報を確認する
成功時、処理を実行し、レスポンスを返す
end note

Back -> DB: 権限内に存在する職員の予定情報を取得
activate DB
DB - -> Back: 職員の予定情報を返却
deactivate DB
Back - -> Gateway: Response"200":{schedules: schedules}
deactivate Back
Gateway - -> Front: Response"200":{schedules: schedules}
deactivate Gateway
Front - -> ユーザー: 画面表示
deactivate Front
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.16+8
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>