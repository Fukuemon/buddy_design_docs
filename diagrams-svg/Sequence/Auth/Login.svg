<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="542px" preserveAspectRatio="none" style="width:933px;height:542px;" version="1.1" viewBox="0 0 933 542" width="933px" zoomAndPan="magnify"><defs><filter height="300%" id="fjv95f6esbd1y" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="340.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="34" y="96.2969"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="319.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="218" y="117.4297"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="453" y="161.6953"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="190.8281"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="830" y="219.9609"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="898.5" y="278.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="39" x2="39" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="222.5" x2="222.5" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="458" x2="458" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="589.5" x2="589.5" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="835" x2="835" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="903" x2="903" y1="86.2969" y2="454.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">ユーザー</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#fjv95f6esbd1y)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="none" filter="url(#fjv95f6esbd1y)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="466.8857">ユーザー</text><ellipse cx="39" cy="480.1875" fill="#FEFECE" filter="url(#fjv95f6esbd1y)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,488.1875 L39,515.1875 M26,496.1875 L52,496.1875 M39,515.1875 L26,530.1875 M39,515.1875 L52,530.1875 " fill="none" filter="url(#fjv95f6esbd1y)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="182.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="189.5" y="70.9951">Frontend</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="182.5" y="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="189.5" y="473.8857">Frontend</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="409" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="416" y="70.9951">APIGateway</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="409" y="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="416" y="473.8857">APIGateway</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="550.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="557.5" y="70.9951">Backend</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="550.5" y="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="557.5" y="473.8857">Backend</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="799" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="806" y="70.9951">Cognito</text><rect fill="#FEFECE" filter="url(#fjv95f6esbd1y)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="799" y="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="806" y="473.8857">Cognito</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="881" y="82.9951">Redis</text><path d="M885.5,34 C885.5,24 903.5,24 903.5,24 C903.5,24 921.5,24 921.5,34 L921.5,60 C921.5,70 903.5,70 903.5,70 C903.5,70 885.5,70 885.5,60 L885.5,34 " fill="#FEFECE" filter="url(#fjv95f6esbd1y)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M885.5,34 C885.5,44 903.5,44 903.5,44 C903.5,44 921.5,44 921.5,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="881" y="466.8857">Redis</text><path d="M885.5,480.1875 C885.5,470.1875 903.5,470.1875 903.5,470.1875 C903.5,470.1875 921.5,470.1875 921.5,480.1875 L921.5,506.1875 C921.5,516.1875 903.5,516.1875 903.5,516.1875 C903.5,516.1875 885.5,516.1875 885.5,506.1875 L885.5,480.1875 " fill="#FEFECE" filter="url(#fjv95f6esbd1y)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M885.5,480.1875 C885.5,490.1875 903.5,490.1875 903.5,490.1875 C903.5,490.1875 921.5,490.1875 921.5,480.1875 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="340.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="34" y="96.2969"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="319.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="218" y="117.4297"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="453" y="161.6953"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="190.8281"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="830" y="219.9609"/><rect fill="#FFFFFF" filter="url(#fjv95f6esbd1y)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="898.5" y="278.2266"/><polygon fill="#A80036" points="206,113.4297,216,117.4297,206,121.4297,210,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="212" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="51" y="112.3638">ユーザー情報入力</text><polygon fill="#A80036" points="441,157.6953,451,161.6953,441,165.6953,445,161.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="228" x2="447" y1="161.6953" y2="161.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="235" y="141.4966">Post：buddy.api.com/auth/login</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="235" y="156.6294">-body: {username, password}</text><path d="M468,132.9961 L468,157.9961 L694,157.9961 L694,142.9961 L684,132.9961 L468,132.9961 " fill="#FBFB77" filter="url(#fjv95f6esbd1y)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M684,132.9961 L684,142.9961 L694,142.9961 L684,132.9961 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="474" y="150.063">ユーザー情報をAPIGatewayに送信</text><polygon fill="#A80036" points="573,186.8281,583,190.8281,573,194.8281,577,190.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463" x2="579" y1="190.8281" y2="190.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="470" y="185.7622">Post: /auth/login</text><polygon fill="#A80036" points="818,215.9609,828,219.9609,818,223.9609,822,219.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="595" x2="824" y1="219.9609" y2="219.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="602" y="214.895">InitiateAuth(username, password)</text><polygon fill="#A80036" points="606,245.0938,596,249.0938,606,253.0938,602,249.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="600" x2="834" y1="249.0938" y2="249.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="612" y="244.0278">accessToken返却</text><polygon fill="#A80036" points="886.5,274.2266,896.5,278.2266,886.5,282.2266,890.5,278.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="595" x2="892.5" y1="278.2266" y2="278.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="602" y="273.1606">{SessionId: accessToken}を保存</text><polygon fill="#A80036" points="606,303.3594,596,307.3594,606,311.3594,602,307.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="600" x2="902.5" y1="307.3594" y2="307.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="612" y="302.2935">保存完了</text><polygon fill="#A80036" points="474,332.4922,464,336.4922,474,340.4922,470,336.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="468" x2="589" y1="336.4922" y2="336.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="480" y="331.4263">SessionId返却</text><polygon fill="#A80036" points="239,361.625,229,365.625,239,369.625,235,365.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="233" x2="457" y1="365.625" y2="365.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="245" y="360.5591">SessionId返却</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="228" x2="270" y1="394.7578" y2="394.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="270" x2="270" y1="394.7578" y2="407.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="229" x2="270" y1="407.7578" y2="407.7578"/><polygon fill="#A80036" points="239,403.7578,229,407.7578,239,411.7578,235,407.7578" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="235" y="389.6919">CookieにSessionIDを保存</text><polygon fill="#A80036" points="50,432.8906,40,436.8906,50,440.8906,46,436.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="44" x2="222" y1="436.8906" y2="436.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="56" y="431.8247">/calendarへリダイレクト</text><!--MD5=[8f1b547a3ca21a5e0c39dd4e6ffd9d6f]
@startuml Login
Actor ユーザー
Participant Frontend as Front
Participant APIGateway as Gateway
Participant Backend as Back
Participant Cognito
Database Redis

activate ユーザー
ユーザー -> Front: ユーザー情報入力
activate Front
Front -> Gateway: Post：buddy.api.com/auth/login \n-body: {username, password}
activate Gateway
note right
  ユーザー情報をAPIGatewayに送信
end note
Gateway -> Back: Post: /auth/login
activate Back
Back -> Cognito: InitiateAuth(username, password)

activate Cognito
Cognito - -> Back: accessToken返却
deactivate Cognito

Back -> Redis: {SessionId: accessToken}を保存
activate Redis
Redis - -> Back: 保存完了
deactivate Redis

Back - -> Gateway: SessionId返却
deactivate Back

Gateway - -> Front: SessionId返却
deactivate Gateway

Front - -> Front: CookieにSessionIDを保存
Front - -> ユーザー: /calendarへリダイレクト
deactivate Front
deactivate ユーザー


@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.16+8
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>