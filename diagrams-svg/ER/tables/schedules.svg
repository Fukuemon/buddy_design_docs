<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1006px" preserveAspectRatio="none" style="width:1883px;height:1006px;" version="1.1" viewBox="0 0 1883 1006" width="1883px" zoomAndPan="magnify"><defs><filter height="300%" id="f194dxru1c6bt3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[d793eab0308b02564d964ddad9e6e3f5]
cluster 予定--><polygon fill="#FFFFFF" filter="url(#f194dxru1c6bt3)" points="22,24,56,24,63,46.2969,1397,46.2969,1397,748,22,748,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="63" y1="46.2969" y2="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="26" y="38.9951">予定</text><!--MD5=[2357de52a651de3e3141a47d68960241]
cluster 住所--><polygon fill="#FFFFFF" filter="url(#f194dxru1c6bt3)" points="1603,895,1637,895,1644,917.2969,1733,917.2969,1733,994,1603,994,1603,895" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1603" x2="1644" y1="917.2969" y2="917.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="1607" y="909.9951">住所</text><!--MD5=[af7553808e27414a6663019e1dd2c0e6]
cluster 職員情報--><polygon fill="#FFFFFF" filter="url(#f194dxru1c6bt3)" points="1561,375,1623,375,1630,397.2969,1661,397.2969,1661,474,1561,474,1561,375" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1561" x2="1630" y1="397.2969" y2="397.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="1565" y="389.9951">職員情報</text><!--MD5=[17926c9f6f73500917f0231ee648f0f2]
cluster 患者情報--><polygon fill="#FFFFFF" filter="url(#f194dxru1c6bt3)" points="1745,772,1807,772,1814,794.2969,1861,794.2969,1861,871,1745,871,1745,772" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1745" x2="1814" y1="794.2969" y2="794.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="1749" y="786.9951">患者情報</text><!--MD5=[d43a93bed96446588d3c5fef43396a6d]
cluster 訪問情報--><polygon fill="#FFFFFF" filter="url(#f194dxru1c6bt3)" points="1460,598,1522,598,1529,620.2969,1721,620.2969,1721,871,1460,871,1460,598" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1460" x2="1529" y1="620.2969" y2="620.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="1464" y="612.9951">訪問情報</text><!--MD5=[974574cb1ae3b47966e90db496f42a34]
class schedules--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="227.2656" id="schedules" style="stroke: #A80036; stroke-width: 1.5;" width="376" x="1005" y="59"/><ellipse cx="1156.75" cy="75" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1160.8594,81 L1153.1406,81 L1153.1406,68.6094 L1160.8594,68.6094 L1160.8594,70.7656 L1155.5938,70.7656 L1155.5938,73.4375 L1160.3594,73.4375 L1160.3594,75.5938 L1155.5938,75.5938 L1155.5938,78.8438 L1160.8594,78.8438 L1160.8594,81 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="1177.25" y="79.1543">schedules</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1006" x2="1380" y1="91" y2="91"/><ellipse cx="1016" cy="102" fill="#000000" rx="3" ry="3" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="1025" y="105.2104">binary schedule_id «PK»</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1006" x2="1380" y1="111.8047" y2="111.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="1011" y="126.0151">binary user_id "ユーザーID"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="214" x="1011" y="138.8198">string title "予定のタイトル（NULL_OK)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="236" x="1011" y="151.6245">binary schedule_type_id «FK» "予定の種類"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="347" x="1011" y="164.4292">binary recurring_schedule_id «FK»"繰り返し予定ID（NULL_OK)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="263" x="1011" y="177.2339">binary visit_info_id «FK» "訪問情報ID(NULL_OK)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="227" x="1011" y="190.0386">string description "予定の説明(NULL_OK)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="1011" y="202.8433">datetime visit_date "予定日（YYYY-MM-DD）"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="230" x="1011" y="215.6479">datetime start_time "開始時間（HH:MM）"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="224" x="1011" y="228.4526">datetime end_time "終了時間（HH:MM）"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="344" x="1011" y="241.2573">boolean is_cancelled"キャンセルされたかどうか(default=false)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="312" x="1011" y="254.062">boolean is_overtime_work "時間外勤務か(default=false)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="341" x="1011" y="266.8667">datetime before_change_date "変更前の訪問日（YYYY-MM-DD"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="364" x="1011" y="279.6714">datetime before_change_start_time "変更前の開始時間（HH:MM）"</text><path d="M1035,406.5 L1035,461.8984 A0,0 0 0 0 1035,461.8984 L1381,461.8984 A0,0 0 0 0 1381,461.8984 L1381,416.5 L1371,406.5 L1212,406.5 L1208,286.06 L1204,406.5 L1035,406.5 A0,0 0 0 0 1035,406.5 " fill="#FBFB77" filter="url(#f194dxru1c6bt3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1371,406.5 L1371,416.5 L1381,416.5 L1371,406.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="1041" y="423.5669">繰り返し予定で特定の予定のみ変更された場合、</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="1041" y="438.6997">このテーブルに新しいレコードを追加する</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="1041" y="453.8325">その際に、繰り返し予定のIDと変更前の日時を保存する</text><!--MD5=[5b96f930ea75387137104988349bd03f]
class schedule_types--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="73.6094" id="schedule_types" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="38" y="135.5"/><ellipse cx="82.25" cy="151.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M86.3594,157.5 L78.6406,157.5 L78.6406,145.1094 L86.3594,145.1094 L86.3594,147.2656 L81.0938,147.2656 L81.0938,149.9375 L85.8594,149.9375 L85.8594,152.0938 L81.0938,152.0938 L81.0938,155.3438 L86.3594,155.3438 L86.3594,157.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="102.75" y="155.6543">schedule_types</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="231" y1="167.5" y2="167.5"/><ellipse cx="49" cy="178.5" fill="#000000" rx="3" ry="3" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="58" y="181.7104">binary schedule_type_id «PK»</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="231" y1="188.3047" y2="188.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="44" y="202.5151">string name "予定のタイプ名"</text><path d="M37.5,414 L37.5,454.2656 A0,0 0 0 0 37.5,454.2656 L126.5,454.2656 A0,0 0 0 0 126.5,454.2656 L126.5,424 L116.5,414 L86.25,414 L82.25,209.69 L78.25,414 L37.5,414 A0,0 0 0 0 37.5,414 " fill="#FBFB77" filter="url(#f194dxru1c6bt3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M116.5,414 L116.5,424 L126.5,424 L116.5,414 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="43.5" y="431.0669">1: 通常業務</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="43.5" y="446.1997">3: 訪問</text><!--MD5=[4bac50278a7bf155671162b306843454]
class schedule_cancels--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="99.2188" id="schedule_cancels" style="stroke: #A80036; stroke-width: 1.5;" width="284" x="716" y="384.5"/><ellipse cx="798.25" cy="400.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M802.3594,406.5 L794.6406,406.5 L794.6406,394.1094 L802.3594,394.1094 L802.3594,396.2656 L797.0938,396.2656 L797.0938,398.9375 L801.8594,398.9375 L801.8594,401.0938 L797.0938,401.0938 L797.0938,404.3438 L802.3594,404.3438 L802.3594,406.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="818.75" y="404.6543">schedule_cancels</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="717" x2="999" y1="416.5" y2="416.5"/><ellipse cx="727" cy="427.5" fill="#000000" rx="3" ry="3" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="736" y="430.7104">binary id «PK»</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="717" x2="999" y1="437.3047" y2="437.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="722" y="451.5151">binary schedule_id «FK» "キャンセルされた予定ID"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="722" y="464.3198">string cancel_reason "キャンセル理由"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="722" y="477.1245">datetime cancel_date "キャンセル日時"</text><!--MD5=[b9cd9f7342890dbd17bb89e9676ef692]
class recurring_rules--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="150.4375" id="recurring_rules" style="stroke: #A80036; stroke-width: 1.5;" width="276" x="270" y="582"/><ellipse cx="356.75" cy="598" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M360.8594,604 L353.1406,604 L353.1406,591.6094 L360.8594,591.6094 L360.8594,593.7656 L355.5938,593.7656 L355.5938,596.4375 L360.3594,596.4375 L360.3594,598.5938 L355.5938,598.5938 L355.5938,601.8438 L360.8594,601.8438 L360.8594,604 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="377.25" y="602.1543">recurring_rules</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="271" x2="545" y1="614" y2="614"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="276" y="628.2104">binary recurring_rule_id «PK»</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="271" x2="545" y1="634.8047" y2="634.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="276" y="649.0151">binary schedule_id: スケジュールID «FK»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="264" x="276" y="661.8198">int frequency: "繰り返し頻度（monthly, weekly)"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="276" y="674.6245">int day_of_week: "曜日"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="276" y="687.4292">int day_of_month: "月の日"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="276" y="700.2339">int week_of_month: "月の週"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="276" y="713.0386">datetime start_date: "開始日"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="276" y="725.8433">datetime end_date: "終了日"</text><path d="M162,421.5 L162,446.6328 A0,0 0 0 0 162,446.6328 L320,446.6328 L324,581.92 L328,446.6328 L378,446.6328 A0,0 0 0 0 378,446.6328 L378,431.5 L368,421.5 L162,421.5 A0,0 0 0 0 162,421.5 " fill="#FBFB77" filter="url(#f194dxru1c6bt3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M368,421.5 L368,431.5 L378,431.5 L368,421.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="168" y="438.5669">繰り返し予定のルールを定義する</text><!--MD5=[797a6f84d7b864f3e98c7a18a9a69921]
class recurring_schedules--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="176.0469" id="recurring_schedules" style="stroke: #A80036; stroke-width: 1.5;" width="268" x="413" y="346"/><ellipse cx="479.25" cy="362" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M483.3594,368 L475.6406,368 L475.6406,355.6094 L483.3594,355.6094 L483.3594,357.7656 L478.0938,357.7656 L478.0938,360.4375 L482.8594,360.4375 L482.8594,362.5938 L478.0938,362.5938 L478.0938,365.8438 L483.3594,365.8438 L483.3594,368 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="127" x="499.75" y="366.1543">recurring_schedules</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="414" x2="680" y1="378" y2="378"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="419" y="392.2104">binary recurring_schedule_id «PK»</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="414" x2="680" y1="398.8047" y2="398.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="241" x="419" y="413.0151">binary recurring_rule_id: "繰り返しルールID"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="220" x="419" y="425.8198">binary schedule_type_id: "予定タイプID"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="419" y="438.6245">binary visit_info_id: "訪問情報ID"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="256" x="419" y="451.4292">binary schedule_category_id: "予定カテゴリID"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="419" y="464.2339">string title: "タイトル"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="419" y="477.0386">string description: "説明"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="419" y="489.8433">datetime visit_date: "訪問日"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="419" y="502.6479">datetime start_time: "開始時間"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="419" y="515.4526">datetime end_time: "終了時間"</text><path d="M367.5,152.5 L367.5,192.7656 A0,0 0 0 0 367.5,192.7656 L543,192.7656 L547,345.74 L551,192.7656 L726.5,192.7656 A0,0 0 0 0 726.5,192.7656 L726.5,162.5 L716.5,152.5 L367.5,152.5 A0,0 0 0 0 367.5,152.5 " fill="#FBFB77" filter="url(#f194dxru1c6bt3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M716.5,152.5 L716.5,162.5 L726.5,162.5 L716.5,152.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="373.5" y="169.5669">繰り返し予定の情報を保存する</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="338" x="373.5" y="184.6997">繰り返しタイプに基づいて、フロント側で予定を複製する</text><!--MD5=[d7d6b8ea598e54491e439553c4a99edb]
class addresses--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="addresses" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1619" y="930"/><ellipse cx="1634" cy="946" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1638.1094,952 L1630.3906,952 L1630.3906,939.6094 L1638.1094,939.6094 L1638.1094,941.7656 L1632.8438,941.7656 L1632.8438,944.4375 L1637.6094,944.4375 L1637.6094,946.5938 L1632.8438,946.5938 L1632.8438,949.8438 L1638.1094,949.8438 L1638.1094,952 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="1648" y="950.1543">addresses</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1620" x2="1716" y1="962" y2="962"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1620" x2="1716" y1="970" y2="970"/><!--MD5=[8413f8248b2da7966d2de021109ec289]
class users--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="users" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="1577.5" y="410"/><ellipse cx="1592.5" cy="426" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1596.6094,432 L1588.8906,432 L1588.8906,419.6094 L1596.6094,419.6094 L1596.6094,421.7656 L1591.3438,421.7656 L1591.3438,424.4375 L1596.1094,424.4375 L1596.1094,426.5938 L1591.3438,426.5938 L1591.3438,429.8438 L1596.6094,429.8438 L1596.6094,432 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="1606.5" y="430.1543">users</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1578.5" x2="1643.5" y1="442" y2="442"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1578.5" x2="1643.5" y1="450" y2="450"/><!--MD5=[5f57dc4600bb33255e6857fe60f92832]
class patients--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="patients" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="1761" y="807"/><ellipse cx="1776" cy="823" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1780.1094,829 L1772.3906,829 L1772.3906,816.6094 L1780.1094,816.6094 L1780.1094,818.7656 L1774.8438,818.7656 L1774.8438,821.4375 L1779.6094,821.4375 L1779.6094,823.5938 L1774.8438,823.5938 L1774.8438,826.8438 L1780.1094,826.8438 L1780.1094,829 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="1790" y="827.1543">patients</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1762" x2="1844" y1="839" y2="839"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1762" x2="1844" y1="847" y2="847"/><!--MD5=[8d41beee1a3a43cb45bc7f02531b65aa]
class visit_infos--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="visit_infos" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1613" y="633"/><ellipse cx="1628" cy="649" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1632.1094,655 L1624.3906,655 L1624.3906,642.6094 L1632.1094,642.6094 L1632.1094,644.7656 L1626.8438,644.7656 L1626.8438,647.4375 L1631.6094,647.4375 L1631.6094,649.5938 L1626.8438,649.5938 L1626.8438,652.8438 L1632.1094,652.8438 L1632.1094,655 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="1642" y="653.1543">visit_infos</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1614" x2="1704" y1="665" y2="665"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1614" x2="1704" y1="673" y2="673"/><!--MD5=[974c6912de8d83cf8a8aca8903c83a0e]
class service_codes--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="service_codes" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="1476" y="807"/><ellipse cx="1491" cy="823" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1495.1094,829 L1487.3906,829 L1487.3906,816.6094 L1495.1094,816.6094 L1495.1094,818.7656 L1489.8438,818.7656 L1489.8438,821.4375 L1494.6094,821.4375 L1494.6094,823.5938 L1489.8438,823.5938 L1489.8438,826.8438 L1495.1094,826.8438 L1495.1094,829 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="1505" y="827.1543">service_codes</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1477" x2="1595" y1="839" y2="839"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1477" x2="1595" y1="847" y2="847"/><!--MD5=[4e5e1fd7835748d2130dd04f1359b45f]
class routes--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="routes" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="1631.5" y="807"/><ellipse cx="1646.5" cy="823" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1650.6094,829 L1642.8906,829 L1642.8906,816.6094 L1650.6094,816.6094 L1650.6094,818.7656 L1645.3438,818.7656 L1645.3438,821.4375 L1650.1094,821.4375 L1650.1094,823.5938 L1645.3438,823.5938 L1645.3438,826.8438 L1650.6094,826.8438 L1650.6094,829 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="41" x="1660.5" y="827.1543">routes</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1632.5" x2="1703.5" y1="839" y2="839"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1632.5" x2="1703.5" y1="847" y2="847"/><!--MD5=[903665769f157e20c63008847d5fc6f3]
class schedule_rules--><rect fill="#FEFECE" filter="url(#f194dxru1c6bt3)" height="48" id="schedule_rules" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="1416" y="410"/><ellipse cx="1431" cy="426" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1433.9688,431.6406 Q1433.3906,431.9375 1432.75,432.0781 Q1432.1094,432.2344 1431.4063,432.2344 Q1428.9063,432.2344 1427.5781,430.5938 Q1426.2656,428.9375 1426.2656,425.8125 Q1426.2656,422.6875 1427.5781,421.0313 Q1428.9063,419.375 1431.4063,419.375 Q1432.1094,419.375 1432.75,419.5313 Q1433.4063,419.6875 1433.9688,419.9844 L1433.9688,422.7031 Q1433.3438,422.125 1432.75,421.8594 Q1432.1563,421.5781 1431.5313,421.5781 Q1430.1875,421.5781 1429.5,422.6563 Q1428.8125,423.7188 1428.8125,425.8125 Q1428.8125,427.9063 1429.5,428.9844 Q1430.1875,430.0469 1431.5313,430.0469 Q1432.1563,430.0469 1432.75,429.7813 Q1433.3438,429.5 1433.9688,428.9219 L1433.9688,431.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="1445" y="430.1543">schedule_rules</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1417" x2="1541" y1="442" y2="442"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1417" x2="1541" y1="450" y2="450"/><!--MD5=[71fc5a0492f46b52026836a03787d46e]
link schedules to users--><path d="M1389.21,173 C1389.21,173 1611,173 1611,173 C1611,173 1611,401.91 1611,401.91 " fill="none" id="schedules-users" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1615" x2="1607" y1="405.91" y2="405.91"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1615" x2="1607" y1="402.91" y2="402.91"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1611" x2="1611" y1="401.91" y2="409.91"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1389.21" x2="1381.21" y1="173" y2="179"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1389.21" x2="1381.21" y1="173" y2="167"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1389.21" x2="1381.21" y1="173" y2="173"/><ellipse cx="1395.21" cy="173" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[3fe5e276e884d9aeaf58fc38bc296c59]
link schedules to schedule_cancels--><path d="M1027.5,294.21 C1027.5,294.21 1027.5,396 1027.5,396 C1027.5,396 1008.27,396 1008.27,396 " fill="none" id="schedules-schedule_cancels" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1011.27" x2="1000.27" y1="396" y2="396"/><ellipse cx="1011.27" cy="396" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1004.27" x2="1004.27" y1="400" y2="392"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1023.5" x2="1031.5" y1="290.21" y2="290.21"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1023.5" x2="1031.5" y1="293.21" y2="293.21"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1027.5" x2="1027.5" y1="294.21" y2="286.21"/><!--MD5=[3828d145f2e0b4014fec993708d6af22]
link schedules to schedule_rules--><path d="M1388.37,230 C1388.37,230 1479,230 1479,230 C1479,230 1479,402.8 1479,402.8 " fill="none" id="schedules-schedule_rules" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1483" x2="1475" y1="405.8" y2="405.8"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1483" x2="1475" y1="402.8" y2="402.8"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1479" x2="1479" y1="401.8" y2="409.8"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1385.37" x2="1385.37" y1="234" y2="226"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1388.37" x2="1388.37" y1="234" y2="226"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1389.37" x2="1381.37" y1="230" y2="230"/><!--MD5=[5cd28357095a326e2c79d26a4e581c54]
link schedules to recurring_schedules--><path d="M1012.5,294.09 C1012.5,294.09 1012.5,359 1012.5,359 C1012.5,359 689.02,359 689.02,359 " fill="none" id="schedules-recurring_schedules" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692.02" x2="681.02" y1="359" y2="359"/><ellipse cx="692.02" cy="359" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="685.02" x2="685.02" y1="363" y2="355"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1012.5" x2="1006.5" y1="294.09" y2="286.09"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1012.5" x2="1018.5" y1="294.09" y2="286.09"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1012.5" x2="1012.5" y1="294.09" y2="286.09"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1008.5" x2="1016.5" y1="296.09" y2="296.09"/><!--MD5=[7586d0c336d4098fc7d6971293f64c52]
link recurring_schedules to schedules--><path d="M689.28,372 C689.28,372 1020,372 1020,372 C1020,372 1020,294.24 1020,294.24 " fill="none" id="recurring_schedules-schedules" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1020" x2="1014" y1="294.24" y2="286.24"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1020" x2="1026" y1="294.24" y2="286.24"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1020" x2="1020" y1="294.24" y2="286.24"/><ellipse cx="1020" cy="300.24" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="685.28" x2="685.28" y1="376" y2="368"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="688.28" x2="688.28" y1="376" y2="368"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="689.28" x2="681.28" y1="372" y2="372"/><!--MD5=[5b341626f80826ad54f570b4464b5a56]
link schedules to visit_infos--><path d="M1389.33,116 C1389.33,116 1674.75,116 1674.75,116 C1674.75,116 1674.75,624.7 1674.75,624.7 " fill="none" id="schedules-visit_infos" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1674.75" x2="1674.75" y1="621.7" y2="632.7"/><ellipse cx="1674.75" cy="621.7" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1678.75" x2="1670.75" y1="628.7" y2="628.7"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1385.33" x2="1385.33" y1="120" y2="112"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1388.33" x2="1388.33" y1="120" y2="112"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1389.33" x2="1381.33" y1="116" y2="116"/><!--MD5=[f242e27a6ff7d0d6ad443347d3c0e96e]
link recurring_schedules to recurring_rules--><path d="M479.5,529.14 C479.5,529.14 479.5,574.75 479.5,574.75 " fill="none" id="recurring_schedules-recurring_rules" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483.5" x2="475.5" y1="577.75" y2="577.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483.5" x2="475.5" y1="574.75" y2="574.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="479.5" x2="479.5" y1="573.75" y2="581.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="475.5" x2="483.5" y1="526.14" y2="526.14"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="475.5" x2="483.5" y1="529.14" y2="529.14"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="479.5" x2="479.5" y1="530.14" y2="522.14"/><!--MD5=[f7f397b51a8c105ad9019a9ac01ddb07]
link recurring_schedules to visit_infos--><path d="M688,503 C688,503 1628.75,503 1628.75,503 C1628.75,503 1628.75,625.94 1628.75,625.94 " fill="none" id="recurring_schedules-visit_infos" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632.75" x2="1624.75" y1="628.94" y2="628.94"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632.75" x2="1624.75" y1="625.94" y2="625.94"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1628.75" x2="1628.75" y1="624.94" y2="632.94"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="685" x2="685" y1="507" y2="499"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="688" x2="688" y1="507" y2="499"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="689" x2="681" y1="503" y2="503"/><!--MD5=[53b8d5c155bb77d592ab98df4467b58b]
link visit_infos to service_codes--><path d="M1605.83,657 C1605.83,657 1586.75,657 1586.75,657 C1586.75,657 1586.75,799.81 1586.75,799.81 " fill="none" id="visit_infos-service_codes" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1590.75" x2="1582.75" y1="802.81" y2="802.81"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1590.75" x2="1582.75" y1="799.81" y2="799.81"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1586.75" x2="1586.75" y1="798.81" y2="806.81"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1608.83" x2="1608.83" y1="653" y2="661"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1605.83" x2="1605.83" y1="653" y2="661"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1604.83" x2="1612.83" y1="657" y2="657"/><!--MD5=[1e54e2c799655c2a2b6ce00a54fef805]
link visit_infos to patients--><path d="M1712.36,657 C1712.36,657 1803,657 1803,657 C1803,657 1803,799.81 1803,799.81 " fill="none" id="visit_infos-patients" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1807" x2="1799" y1="802.81" y2="802.81"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1807" x2="1799" y1="799.81" y2="799.81"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1803" x2="1803" y1="798.81" y2="806.81"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1709.36" x2="1709.36" y1="661" y2="653"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1712.36" x2="1712.36" y1="661" y2="653"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1713.36" x2="1705.36" y1="657" y2="657"/><!--MD5=[00c9d5881ccfb62228fb4fbc007c8088]
link visit_infos to routes--><path d="M1668,688.19 C1668,688.19 1668,799.73 1668,799.73 " fill="none" id="visit_infos-routes" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1672" x2="1664" y1="802.73" y2="802.73"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1672" x2="1664" y1="799.73" y2="799.73"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1668" x2="1668" y1="798.73" y2="806.73"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1664" x2="1672" y1="685.19" y2="685.19"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1664" x2="1672" y1="688.19" y2="688.19"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1668" x2="1668" y1="689.19" y2="681.19"/><!--MD5=[7e50c4e28511e5786c68e5dd52f3e12a]
link routes to addresses--><path d="M1668,863.01 C1668,863.01 1668,921.63 1668,921.63 " fill="none" id="routes-addresses" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1668" x2="1674" y1="921.63" y2="929.63"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1668" x2="1662" y1="921.63" y2="929.63"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1668" x2="1668" y1="921.63" y2="929.63"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1672" x2="1664" y1="919.63" y2="919.63"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1664" x2="1672" y1="859.01" y2="859.01"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1664" x2="1672" y1="862.01" y2="862.01"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1668" x2="1668" y1="863.01" y2="855.01"/><!--MD5=[adf3f877f5237fca3a038b5ba1edde91]
@startuml entity-relationship-diagram
skinparam linetype ortho

package 予定 {
  entity schedules {
    * binary schedule_id <<PK>>
    - -
    binary user_id "ユーザーID"
    string title "予定のタイトル（NULL_OK)"
    binary schedule_type_id <<FK>> "予定の種類"
    binary recurring_schedule_id <<FK>>"繰り返し予定ID（NULL_OK)"
    binary visit_info_id <<FK>> "訪問情報ID(NULL_OK)"
    string description "予定の説明(NULL_OK)"
    datetime visit_date "予定日（YYYY-MM-DD）"
    datetime start_time "開始時間（HH:MM）"
    datetime end_time "終了時間（HH:MM）"
    boolean is_cancelled"キャンセルされたかどうか(default=false)"
    boolean is_overtime_work "時間外勤務か(default=false)"
    datetime before_change_date "変更前の訪問日（YYYY-MM-DD"
    datetime before_change_start_time "変更前の開始時間（HH:MM）"
  }

  note bottom of schedules
    繰り返し予定で特定の予定のみ変更された場合、
    このテーブルに新しいレコードを追加する
    その際に、繰り返し予定のIDと変更前の日時を保存する
  end note

  entity schedule_types {
    * binary schedule_type_id <<PK>>
    - -
    string name "予定のタイプ名"
  }

  note bottom of schedule_types
    1: 通常業務
    3: 訪問
  end note

  entity schedule_cancels {
    * binary id <<PK>>
    - -
    binary schedule_id <<FK>> "キャンセルされた予定ID"
    string cancel_reason "キャンセル理由"
    datetime cancel_date "キャンセル日時"
  }

  entity recurring_rules {
    binary recurring_rule_id <<PK>>
    - -
    binary schedule_id: スケジュールID <<FK>>
    int frequency: "繰り返し頻度（monthly, weekly)"
    int day_of_week: "曜日"
    int day_of_month: "月の日"
    int week_of_month: "月の週"
    datetime start_date: "開始日"
    datetime end_date: "終了日"
  }
  note top of recurring_rules
  繰り返し予定のルールを定義する
  end note

  entity recurring_schedules {
    binary recurring_schedule_id <<PK>>
    - -
    binary recurring_rule_id: "繰り返しルールID"
    binary schedule_type_id: "予定タイプID"
    binary visit_info_id: "訪問情報ID"
    binary schedule_category_id: "予定カテゴリID"
    string title: "タイトル"
    string description: "説明"
    datetime visit_date: "訪問日"
    datetime start_time: "開始時間"
    datetime end_time: "終了時間"
  }
  note top of recurring_schedules
    繰り返し予定の情報を保存する
    繰り返しタイプに基づいて、フロント側で予定を複製する
  end note
}

package 住所 {
  entity addresses
}

package 職員情報 {
  entity users {
  }
}

package 患者情報 {
  entity patients {
  }
}

package 訪問情報 {
  entity visit_infos {
  }
  entity service_codes {
  }
  entity routes {
  }
}

schedules }o- -|| users
schedules ||- -o| schedule_cancels
schedules ||- -|| schedule_rules
schedules }|- -o| recurring_schedules
schedules ||- -o| visit_infos
recurring_schedules ||- -o{ schedules
recurring_schedules ||- -|| recurring_rules
recurring_schedules ||- -|| visit_infos
visit_infos ||- -|| service_codes
visit_infos ||- -|| patients
visit_infos ||- -|| routes
routes ||- -|{ addresses

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.16+8
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>